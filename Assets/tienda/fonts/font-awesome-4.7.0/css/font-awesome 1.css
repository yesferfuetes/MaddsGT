plocm}","ui/appBarIcons/important":"","_ui/appBarIcons/important.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mailreply":"","_ui/appBarIcons/mailreply.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/slideshow":"","_ui/appBarIcons/slideshow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/sort":"","_ui/appBarIcons/sort.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/manage":"","_ui/appBarIcons/manage.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/allapps":"","_ui/appBarIcons/allapps.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/disconnectdrive":"","_ui/appBarIcons/disconnectdrive.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mapdrive":"","_ui/appBarIcons/mapdrive.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/newwindow":"","_ui/appBarIcons/newwindow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openwith":"","_ui/appBarIcons/openwith.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/contactpresence":"","_ui/appBarIcons/contactpresence.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/priority":"","_ui/appBarIcons/priority.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/uploadskydrive":"","_ui/appBarIcons/uploadskydrive.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/gototoday":"","_ui/appBarIcons/gototoday.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/font":"","_ui/appBarIcons/font.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontcolor":"","_ui/appBarIcons/fontcolor.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/contact2":"","_ui/appBarIcons/contact2.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/folder":"","_ui/appBarIcons/folder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/audio":"","_ui/appBarIcons/audio.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/placeholder":"","_ui/appBarIcons/placeholder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/view":"","_ui/appBarIcons/view.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/setlockscreen":"","_ui/appBarIcons/setlockscreen.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/settile":"","_ui/appBarIcons/settile.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/cc":"","_ui/appBarIcons/cc.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/stopslideshow":"","_ui/appBarIcons/stopslideshow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/permissions":"","_ui/appBarIcons/permissions.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/highlight":"","_ui/appBarIcons/highlight.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/disableupdates":"","_ui/appBarIcons/disableupdates.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/unfavorite":"","_ui/appBarIcons/unfavorite.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/unpin":"","_ui/appBarIcons/unpin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openlocal":"","_ui/appBarIcons/openlocal.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/mute":"","_ui/appBarIcons/mute.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/italic":"","_ui/appBarIcons/italic.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/underline":"","_ui/appBarIcons/underline.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/bold":"","_ui/appBarIcons/bold.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/movetofolder":"","_ui/appBarIcons/movetofolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/likedislike":"","_ui/appBarIcons/likedislike.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/dislike":"","_ui/appBarIcons/dislike.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/like":"","_ui/appBarIcons/like.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/alignright":"","_ui/appBarIcons/alignright.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/aligncenter":"","_ui/appBarIcons/aligncenter.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/alignleft":"","_ui/appBarIcons/alignleft.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zoom":"","_ui/appBarIcons/zoom.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zoomout":"","_ui/appBarIcons/zoomout.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/openfile":"","_ui/appBarIcons/openfile.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/otheruser":"","_ui/appBarIcons/otheruser.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/admin":"","_ui/appBarIcons/admin.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/street":"","_ui/appBarIcons/street.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/map":"","_ui/appBarIcons/map.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/clearselection":"","_ui/appBarIcons/clearselection.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontdecrease":"","_ui/appBarIcons/fontdecrease.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontincrease":"","_ui/appBarIcons/fontincrease.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fontsize":"","_ui/appBarIcons/fontsize.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/cellphone":"","_ui/appBarIcons/cellphone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/reshare":"","_ui/appBarIcons/reshare.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/tag":"","_ui/appBarIcons/tag.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/repeatone":"","_ui/appBarIcons/repeatone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/repeatall":"","_ui/appBarIcons/repeatall.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/outlinestar":"","_ui/appBarIcons/outlinestar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/solidstar":"","_ui/appBarIcons/solidstar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calculator":"","_ui/appBarIcons/calculator.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/directions":"","_ui/appBarIcons/directions.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/target":"","_ui/appBarIcons/target.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/library":"","_ui/appBarIcons/library.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/phonebook":"","_ui/appBarIcons/phonebook.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/memo":"","_ui/appBarIcons/memo.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/microphone":"","_ui/appBarIcons/microphone.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/postupdate":"","_ui/appBarIcons/postupdate.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/backtowindow":"","_ui/appBarIcons/backtowindow.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fullscreen":"","_ui/appBarIcons/fullscreen.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/newfolder":"","_ui/appBarIcons/newfolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/calendarreply":"","_ui/appBarIcons/calendarreply.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/unsyncfolder":"","_ui/appBarIcons/unsyncfolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/reporthacked":"","_ui/appBarIcons/reporthacked.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/syncfolder":"","_ui/appBarIcons/syncfolder.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/blockcontact":"","_ui/appBarIcons/blockcontact.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/switchapps":"","_ui/appBarIcons/switchapps.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/addfriend":"","_ui/appBarIcons/addfriend.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/touchpointer":"","_ui/appBarIcons/touchpointer.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/gotostart":"","_ui/appBarIcons/gotostart.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/zerobars":"","_ui/appBarIcons/zerobars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/onebar":"","_ui/appBarIcons/onebar.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/twobars":"","_ui/appBarIcons/twobars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/threebars":"","_ui/appBarIcons/threebars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/fourbars":"","_ui/appBarIcons/fourbars.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/scan":"","_ui/appBarIcons/scan.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/preview":"","_ui/appBarIcons/preview.comment":"{Locked=qps-ploc,qps-plocm}","ui/appBarIcons/hamburger":"","_ui/appBarIcons/hamburger.comment":"{Locked=qps-ploc,qps-plocm}"}),r("WinJS/Core/_Resources",["exports","./_Global","./_WinRT","./_Base","./_Events","require-json!strings/en-us/Microsoft.WinJS.resjson",],function(n,t,i,r,u,f){"use strict";function a(n){var t=c("ms-resource:///Microsoft.WinJS/"+n);return t.empty&&(t=p(n)),t}function p(n){var t=f[n];return typeof t=="string"&&(t={value:t}),t||{value:n,empty:!0}}function l(n){var t=arguments;return t.length>1&&(n=n.replace(/({{)|(}})|{(\d+)}|({)|(})/g,function(n,i,r,u,f,e){if(f||e)throw l(k.malformedFormatStringInput,f||e);return i&&"{"||r&&"}"||t[(u|0)+1]})),n}var e,v=!1,s="contextchanged",h,w=r.Class.mix(r.Class.define(null,{},{supportedForProcessing:!1}),u.eventMixin),o=new w,b=u._createEventProperty,k={get malformedFormatStringInput(){return"Malformed, did you mean to escape your '{0}'?"}},y,c;r.Namespace.define("WinJS.Resources",{_getWinJSString:a});r.Namespace._moduleDefine(n,"WinJS.Resources",{addEventListener:function(t,r,u){if(i.Windows.ApplicationModel.Resources.Core.ResourceManager&&!v&&t===s)try{var f=n._getResourceContext();f?f.qualifierValues.addEventListener("mapchanged",function(t){n.dispatchEvent(s,{qualifier:t.key,changed:t.target[t.key]})},!1):i.Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.qualifierValues.addEventListener("mapchanged",function(t){n.dispatchEvent(s,{qualifier:t.key,changed:t.target[t.key]})},!1);v=!0}catch(e){}o.addEventListener(t,r,u)},removeEventListener:o.removeEventListener.bind(o),dispatchEvent:o.dispatchEvent.bind(o),_formatString:l,_getStringWinRT:function(t){var f,r,s,u,o;if(!e){f=i.Windows.ApplicationModel.Resources.Core.ResourceManager.current.mainResourceMap;try{e=f.getSubtree("Resources")}catch(h){}e||(e=f)}try{o=n._getResourceContext();u=o?e.getValue(t,o):e.getValue(t);u&&(r=u.valueAsString,r===undefined&&(r=u.toString()))}catch(h){}if(!r)return n._getStringJS(t);try{s=u.getQualifierValue("Language")}catch(h){return{value:r}}return{value:r,lang:s}},_getStringJS:function(n){var i=t.strings&&t.strings[n];return typeof i=="string"&&(i={value:i}),i||{value:n,empty:!0}},_getResourceContext:function(){if(t.document&&typeof h=="undefined"){var n=i.Windows.ApplicationModel.Resources.Core.ResourceContext;h=n.getForCurrentView?n.getForCurrentView():null}return h},oncontextchanged:b(s)});y=i.Windows.ApplicationModel.Resources.Core.ResourceManager?n._getStringWinRT:n._getStringJS;c=function(n){return y(n)};r.Namespace._moduleDefine(n,null,{_formatString:l,_getWinJSString:a});r.Namespace._moduleDefine(n,"WinJS.Resources",{getString:{get:function(){return c},set:function(n){c=n}}})}),r("WinJS/Core/_Trace",["./_Global"],function(n){"use strict";function t(n){return n}return{_traceAsyncOperationStarting:n.Debug&&n.Debug.msTraceAsyncOperationStarting&&n.Debug.msTraceAsyncOperationStarting.bind(n.Debug)||t,_traceAsyncOperationCompleted:n.Debug&&n.Debug.msTraceAsyncOperationCompleted&&n.Debug.msTraceAsyncOperationCompleted.bind(n.Debug)||t,_traceAsyncCallbackStarting:n.Debug&&n.Debug.msTraceAsyncCallbackStarting&&n.Debug.msTraceAsyncCallbackStarting.bind(n.Debug)||t,_traceAsyncCallbackCompleted:n.Debug&&n.Debug.msTraceAsyncCallbackCompleted&&n.Debug.msTraceAsyncCallbackCompleted.bind(n.Debug)||t}}),r("WinJS/Promise/_StateMachine",["../Core/_Global","../Core/_BaseCoreUtils","../Core/_Base","../Core/_ErrorFromName","../Core/_Events","../Core/_Trace"],function(n,t,i,r,u,f){"use strict";function e(){}function g(n,t){var i;i=t&&typeof t=="object"&&typeof t.then=="function"?p:dt;n._value=t;n._setState(i)}function nt(n,t,i,r,u,f){return{exception:n,error:t,promise:i,handler:f,id:r,parent:u}}function tt(n,t,i,r){var u=i._isException,f=i._errorId;return nt(u?t:null,u?null:t,n,f,i,r)}function gt(n,t,i){var r=i._isException,u=i._errorId;return vt(n,u,r),nt(r?t:null,r?null:t,n,u,i)}function ni(n,t){var i=++ht;return vt(n,i),nt(null,t,n,i)}function ti(n,t){var i=++ht;return vt(n,i,!0),nt(t,null,n,i)}function it(n,t,i,r){var u=f._traceAsyncOperationStarting("WinJS.Promise.done");at(n,{c:t,e:i,p:r,asyncOpID:u})}function rt(n,t,i,r){n._value=t;l(n,t,i,r);n._setState(lt)}function ii(t,i){var l=t._value,u=t._listeners,e,s;if(u)for(t._listeners=null,e=0,s=Array.isArray(u)?u.length:1;e<s;e++){var o=s===1?u:u[e],h=o.c,r=o.promise;if(f._traceAsyncOperationCompleted(o.asyncOpID,n.Debug&&n.Debug.MS_ASYNC_OP_STATUS_SUCCESS),r){f._traceAsyncCallbackStarting(o.asyncOpID);try{r._setCompleteValue(h?h(l):l)}catch(a){r._setExceptionValue(a)}finally{f._traceAsyncCallbackCompleted()}r._state!==p&&r._listeners&&i.push(r)}else c.prototype.done.call(t,h)}}function ri(t,i){var u=t._value,e=t._listeners,s,c,v;if(e)for(t._listeners=null,s=0,c=Array.isArray(e)?e.length:1;s<c;s++){var h=c===1?e:e[s],o=h.e,r=h.promise,w=n.Debug&&(u&&u.name===y?n.Debug.MS_ASYNC_OP_STATUS_CANCELED:n.Debug.MS_ASYNC_OP_STATUS_ERROR);if(f._traceAsyncOperationCompleted(h.asyncOpID,w),r){v=!1;try{o?(f._traceAsyncCallbackStarting(h.asyncOpID),v=!0,o.handlesOnError||l(r,u,tt,t,o),r._setCompleteValue(o(u))):r._setChainedErrorValue(u,t)}catch(b){r._setExceptionValue(b)}finally{v&&f._traceAsyncCallbackCompleted()}r._state!==p&&r._listeners&&i.push(r)}else a.prototype.done.call(t,null,o)}}function l(n,t,i,r,u){if(v._listeners[st]){if(t instanceof Error&&t.message===y)return;v.dispatchEvent(st,i(n,t,r,u))}}function ut(n,t){var r=n._listeners,u,f,i,e;if(r)for(u=0,f=Array.isArray(r)?r.length:1;u<f;u++){if(i=f===1?r:r[u],e=i.p,e)try{e(t)}catch(o){}i.c||i.e||!i.promise||i.promise._progress(t)}}function at(n,t){var i=n._listeners;i?(i=Array.isArray(i)?i:[i],i.push(t)):i=t;n._listeners=i}function vt(n,t,i){n._isException=i||!1;n._errorId=t}function ft(n,t,i,r){n._value=t;l(n,t,i,r);n._setState(k)}function et(n,t){var i;i=t&&typeof t=="object"&&typeof t.then=="function"?p:b;n._value=t;n._setState(i)}function ot(n,t,i,r){var u=new yt(n),e=f._traceAsyncOperationStarting("WinJS.Promise.then");return at(n,{promise:u,c:t,e:i,p:r,asyncOpID:e}),u}function ei(i){var r;return new o(function(u){i?r=n.setTimeout(u,i):t._setImmediate(u)},function(){r&&n.clearTimeout(r)})}function oi(n,t){var r=function(){t.cancel()},i=function(){n.cancel()};return n.then(r),t.then(i,i),t}var pt,v,ht,w,wt,p,bt,kt,ct,dt,b,lt,k,d,fi,o;n.Debug&&(n.Debug.setNonUserCodeExceptions=!0);pt=i.Class.mix(i.Class.define(null,{},{supportedForProcessing:!1}),u.eventMixin);v=new pt;v._listeners={};var st="error",y="Canceled",s=!1,h={promise:1,thenPromise:2,errorPromise:4,exceptionPromise:8,completePromise:16};h.all=h.promise|h.thenPromise|h.errorPromise|h.exceptionPromise|h.completePromise;ht=1;w={name:"created",enter:function(n){n._setState(wt)},cancel:e,done:e,then:e,_completed:e,_error:e,_notify:e,_progress:e,_setCompleteValue:e,_setErrorValue:e};wt={name:"working",enter:e,cancel:function(n){n._setState(kt)},done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};p={name:"waiting",enter:function(n){var t=n._value,i;t instanceof yt&&t._state!==k&&t._state!==b?at(t,{promise:n}):(i=function(r){t._errorId?n._chainedError(r,t):(l(n,r,tt,t,i),n._error(r))},i.handlesOnError=!0,t.then(n._completed.bind(n),i,n._progress.bind(n)))},cancel:function(n){n._setState(bt)},done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};bt={name:"waiting_canceled",enter:function(n){n._setState(ct);var t=n._value;t.cancel&&t.cancel()},cancel:e,done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};kt={name:"canceled",enter:function(n){n._setState(ct);n._cancelAction()},cancel:e,done:it,then:ot,_completed:g,_error:rt,_notify:e,_progress:ut,_setCompleteValue:et,_setErrorValue:ft};ct={name:"canceling",enter:function(n){var t=new Error(y);t.name=t.message;n._value=t;n._setState(lt)},cancel:e,done:e,then:e,_completed:e,_error:e,_notify:e,_progress:e,_setCompleteValue:e,_setErrorValue:e};dt={name:"complete_notify",enter:function(n){if(n.done=c.prototype.done,n.then=c.prototype.then,n._listeners)for(var t=[n],i;t.length;)i=t.shift(),i._state._notify(i,t);n._setState(b)},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ii,_progress:e,_setCompleteValue:e,_setErrorValue:e};b={name:"success",enter:function(n){n.done=c.prototype.done;n.then=c.prototype.then;n._cleanupAction()},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ii,_progress:e,_setCompleteValue:e,_setErrorValue:e};lt={name:"error_notify",enter:function(n){if(n.done=a.prototype.done,n.then=a.prototype.then,n._listeners)for(var t=[n],i;t.length;)i=t.shift(),i._state._notify(i,t);n._setState(k)},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ri,_progress:e,_setCompleteValue:e,_setErrorValue:e};k={name:"error",enter:function(n){n.done=a.prototype.done;n.then=a.prototype.then;n._cleanupAction()},cancel:e,done:null,then:null,_completed:e,_error:e,_notify:ri,_progress:e,_setCompleteValue:e,_setErrorValue:e};d=i.Class.define(null,{_listeners:null,_nextState:null,_state:null,_value:null,cancel:function(){this._state.cancel(this);this._run()},done:function(n,t,i){this._state.done(this,n,t,i)},then:function(n,t,i){return this._state.then(this,n,t,i)},_chainedError:function(n,t){var i=this._state._error(this,n,gt,t);return this._run(),i},_completed:function(n){var t=this._state._completed(this,n);return this._run(),t},_error:function(n){var t=this._state._error(this,n,ni);return this._run(),t},_progress:function(n){this._state._progress(this,n)},_setState:function(n){this._nextState=n},_setCompleteValue:function(n){this._state._setCompleteValue(this,n);this._run()},_setChainedErrorValue:function(n,t){var i=this._state._setErrorValue(this,n,gt,t);return this._run(),i},_setExceptionValue:function(n){var t=this._state._setErrorValue(this,n,ti);return this._run(),t},_run:function(){while(this._nextState)this._state=this._nextState,this._nextState=null,this._state.enter(this)}},{supportedForProcessing:!1});var yt=i.Class.derive(d,function(n){s&&(s===!0||s&h.thenPromise)&&(this._stack=o._getStack());this._creator=n;this._setState(w);this._run()},{_creator:null,_cancelAction:function(){this._creator&&this._creator.cancel()},_cleanupAction:function(){this._creator=null}},{supportedForProcessing:!1}),a=i.Class.define(function(n){s&&(s===!0||s&h.errorPromise)&&(this._stack=o._getStack());this._value=n;l(this,n,ni)},{cancel:function(){},done:function(n,t){var i=this._value,r;if(t)try{t.handlesOnError||l(null,i,tt,this,t);r=t(i);r&&typeof r=="object"&&typeof r.done=="function"&&r.done();return}catch(u){i=u}i instanceof Error&&i.message===y||o._doneHandler(i)},then:function(n,t){if(!t)return this;var i,r=this._value;try{t.handlesOnError||l(null,r,tt,this,t);i=new c(t(r))}catch(u){i=u===r?this:new ui(u)}return i}},{supportedForProcessing:!1}),ui=i.Class.derive(a,function(n){s&&(s===!0||s&h.exceptionPromise)&&(this._stack=o._getStack());this._value=n;l(this,n,ti)},{},{supportedForProcessing:!1}),c=i.Class.define(function(n){if(s&&(s===!0||s&h.completePromise)&&(this._stack=o._getStack()),n&&typeof n=="object"&&typeof n.then=="function"){var t=new yt(null);return t._setCompleteValue(n),t}this._value=n},{cancel:function(){},done:function(n){if(n)try{var t=n(this._value);t&&typeof t=="object"&&typeof t.done=="function"&&t.done()}catch(i){o._doneHandler(i)}},then:function(n){try{var t=n?n(this._value):this._value;return t===this._value?this:new c(t)}catch(i){return new ui(i)}}},{supportedForProcessing:!1});return o=i.Class.derive(d,function(n,t){s&&(s===!0||s&h.promise)&&(this._stack=o._getStack());this._oncancel=t;this._setState(w);this._run();try{var i=this._completed.bind(this),r=this._error.bind(this),u=this._progress.bind(this);n(i,r,u)}catch(f){this._setExceptionValue(f)}},{_oncancel:null,_cancelAction:function(){if(this._oncancel)try{this._oncancel()}catch(n){}},_cleanupAction:function(){this._oncancel=null}},{addEventListener:function(n,t,i){v.addEventListener(n,t,i)},any:function(n){return new o(function(t,i){var r=Object.keys(n),u;r.length===0&&t();u=0;r.forEach(function(f){o.as(n[f]).then(function(){t({key:f,value:n[f]})},function(e){if(e instanceof Error&&e.name===y){++u===r.length&&t(o.cancel);return}i({key:f,value:n[f]})})})},function(){var t=Object.keys(n);t.forEach(function(t){var i=o.as(n[t]);typeof i.cancel=="function"&&i.cancel()})})},as:function(n){return n&&typeof n=="object"&&typeof n.then=="function"?n:new c(n)},cancel:{get:function(){return fi=fi||new a(new r(y))}},dispatchEvent:function(n,t){return v.dispatchEvent(n,t)},is:function(n){return n&&typeof n=="object"&&typeof n.then=="function"},join:function(n){return new o(function(t,i,r){var f=Object.keys(n),u=Array.isArray(n)?[]:{},e=Array.isArray(n)?[]:{},h=0,s=f.length,c=function(n){var h,c;--s==0?(h=Object.keys(u).length,h===0?t(e):(c=0,f.forEach(function(n){var t=u[n];t instanceof Error&&t.name===y&&c++}),c===h?t(o.cancel):i(u))):r({Key:n,Done:!0})};if(f.forEach(function(t){var i=n[t];i===undefined?h++:o.then(i,function(n){e[t]=n;c(t)},function(n){u[t]=n;c(t)})}),s-=h,s===0){t(e);return}},function(){Object.keys(n).forEach(function(t){var i=o.as(n[t]);typeof i.cancel=="function"&&i.cancel()})})},removeEventListener:function(n,t,i){v.removeEventListener(n,t,i)},supportedForProcessing:!1,then:function(n,t,i,r){return o.as(n).then(t,i,r)},thenEach:function(n,t,i,r){var u=Array.isArray(n)?[]:{};return Object.keys(n).forEach(function(f){u[f]=o.as(n[f]).then(t,i,r)}),o.join(u)},timeout:function(n,t){var i=ei(n);return t?oi(i,t):i},wrap:function(n){return new c(n)},wrapError:function(n){return new a(n)},_veryExpensiveTagWithStack:{get:function(){return s},set:function(n){s=n}},_veryExpensiveTagWithStack_tag:h,_getStack:function(){if(n.Debug&&n.Debug.debuggerEnabled)try{throw new Error;}catch(t){return t.stack}},_cancelBlocker:function(n,t){if(!o.is(n))return o.wrap(n);var i,r,u=new o(function(n,t){i=n;r=t},function(){i=null;r=null;t&&t()});return n.then(function(n){i&&i(n)},function(n){r&&r(n)}),u}}),Object.defineProperties(o,u.createEventProperties(st)),o._doneHandler=function(n){t._setImmediate(function(){throw n;})},{PromiseStateMachine:d,Promise:o,state_created:w}}),r("WinJS/Promise",["./Core/_Base","./Promise/_StateMachine"],function(n,t){"use strict";return n.Namespace.define("WinJS",{Promise:t.Promise}),t.Promise}),r("WinJS/Core/_Log",["exports","./_Global","./_Base",],function(n,t,i){"use strict";function o(n,t,i){var u=n;return typeof u=="function"&&(u=u()),(i&&f.test(i)?"":i?i+": ":"")+(t?t.replace(r,":")+": ":"")+u}function s(i,r,u){var e=n.formatLog(i,r,u);t.console&&t.console[u&&f.test(u)?u:"log"](e)}function u(n){return n.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")}var r=/\s+/g,f=/^(error|warn|info|log)$/,e=null;i.Namespace._moduleDefine(n,"WinJS.Utilities",{startLog:function(t){var i;t=t||{};typeof t=="string"&&(t={tags:t});var f=t.type&&new RegExp("^("+u(t.type).replace(r," ").split(" ").join("|")+")$"),e=t.excludeTags&&new RegExp("(^|\\s)("+u(t.excludeTags).replace(r," ").split(" ").join("|")+")(\\s|$)","i"),o=t.tags&&new RegExp("(^|\\s)("+u(t.tags).replace(r," ").split(" ").join("|")+")(\\s|$)","i"),h=t.action||s;if(!f&&!e&&!o&&!n.log){n.log=h;return}i=function(n,t,r){f&&!f.test(r)||e&&e.test(t)||o&&!o.test(t)||h(n,t,r);i.next&&i.next(n,t,r)};i.next=n.log;n.log=i},stopLog:function(){n.log=null},formatLog:o});i.Namespace._moduleDefine(n,"WinJS",{log:{get:function(){return e},set:function(n){e=n}}})}),r("WinJS/Scheduler",["exports","./Core/_Global","./Core/_Base","./Core/_ErrorFromName","./Core/_Log","./Core/_Resources","./Core/_Trace","./Core/_WriteProfilerMark","./Promise"],function(n,t,i,r,u,f,e,o,s){"use strict";function ii(n){var r={},t="_prev"+n,i="_next"+n;return r["_remove"+n]=function(){var n=this[t],r=this[i];r&&(r[t]=n);n&&(n[i]=r);this[t]=null;this[i]=null},r["_insert"+n+"Before"]=function(n){var r=this[t];return r&&(r[i]=n),n[i]=this,n[t]=r,this[t]=n,n},r["_insert"+n+"After"]=function(n){var r=this[i];return this[i]=n,n[i]=r,n[t]=this,r&&(r[t]=n),n},r}function fi(n,t,i){return i!==undefined?"("+n+";"+t+";"+i+")":t!==undefined?"("+n+";"+t+")":n!==undefined?"("+n+")":""}function tt(n,t,i,r){o("WinJS.Scheduler:"+n+fi(i,r)+","+t)}function v(n,t,i,r,u){var f=n.name||r!==undefined||u!==undefined;o("WinJS.Scheduler:"+t+":"+n.id+(f?fi(n.name,r,u):"")+","+i)}function c(){return!1}function ft(n){throw"Illegal call by job("+n.id+") in state: "+this.name;}function g(n){return function(t,i,r){t._setState(n,i,r)}}function wt(n,t){n._setPriority(t)}function lr(n,t){function f(n,t){u.log&&u.log(t+": MARKER: "+n.name,"winjs scheduler","log")}function e(n,t){u.log&&u.log(t+": JOB("+n.id+"): state: "+(n._state?n._state.name:"")+(n.name?", name: "+n.name:""),"winjs scheduler","log")}u.log&&u.log("highWaterMark: "+a,"winjs scheduler","log");var r=0,o=t?bt[bt.length-1]:bt[0],i=o;do i instanceof h&&f(i,r),i instanceof it&&e(i,r),r++,i=t?i["_prev"+n]:i["_next"+n];while(i)}function ar(){function u(t,i){n+="    "+(i?"*":" ")+"id: "+t.id+", priority: "+w(t.priority).name+(t.name?", name: "+t.name:"")+"\n"}var n="",t,r,i,f;for(n+="Jobs:\n",t=w(a),r=0,pt&&(u(pt,!0),r++);t.priority>=p.min;)t instanceof it&&(u(t,!1),r++),t=t._nextJob;for(r===0&&(n+="     None\n"),n+="Drain requests:\n",i=0,f=y.length;i<f;i++)n+="    "+(i===0?"*":" ")+"priority: "+w(y[i].priority).name+", name: "+y[i].name+"\n";return y.length===0&&(n+="     None\n"),n}function vr(){var n=bt[0];do{if(n instanceof it)return!1;n=n._nextJob}while(n);return!0}function rr(){return y.length===0?null:y[0].priority}function si(n){tt("drain","StartTM",n.name,w(n.priority).name)}function ur(n,t){t&&tt("drain-canceled","info",n.name,w(n.priority).name);tt("drain","StopTM",n.name,w(n.priority).name)}function yr(n,t,i){y.push({priority:n,complete:t,name:i});y.length===1&&(si(y[0]),n>a&&(a=n,ct=!0))}function pr(n,t){for(var r=y.length,i=0;i<r;i++)if(y[i].complete===n){i===0&&(ur(y[0],t),y[1]&&si(y[1]));y.splice(i,1);break}}function wr(){var n=y.shift();n&&(ur(n),y[0]&&si(y[0]),n.complete())}function fr(){var t=!1,n;if(!!y.length)for(n=rr();+n===n&&n>a;)kt=n,wr(),t=!0,n=rr();return t}function gt(n){return n>=p.aboveNormal+1?l.HIGH:n>=p.belowNormal?l.NORMAL:l.IDLE}function kr(n,t){return lt[n]>=lt[t]}function dr(n,t){return lt[n]>lt[t]}function er(n){switch(n){case l.HIGH:return!1;case l.NORMAL:return l.isTaskScheduledAtPriorityOrHigher(l.HIGH);case l.IDLE:return l.isTaskScheduledAtPriorityOrHigher(l.NORMAL)}}function gr(n,t){var i=w(t);i.priority>a&&(a=i.priority,ct=!0);i._insertJobAfter(n)}function ci(n,t){var i=w(t);i.priority>a&&(a=i.priority,ct=!0);i._nextMarker._insertJobBefore(n)}function li(n){return n=n|0,n=Math.max(n,cr),Math.min(n,tr)}function w(n){return n=li(n),bt[-1*(n-tr)]}function nu(n){var c,s,e,b;ni=!0;tt("timeslice","StartTM");var r,u=!0,t,i,o=!1,f=!1;ct=!1;try{for(var k=ai(),d=k+ir,h=function(){return(o=!1,ct)?!0:er(gt(a))?!0:!y.length?ai()>d?(o=!0,!0):!1:!1};a>=p.min&&!h()&&!f;){r=!1;t=w(a)._nextJob;do kt=t.priority,t instanceof it?(i!==t.priority&&(+i===i&&tt("priority","StopTM",w(i).name),tt("priority","StartTM",w(t.priority).name),i=t.priority),r=!0,u=!1,pt=t,v(pt,"job-running","StartTM",w(kt).name),t._execute(h),v(pt,"job-running","StopTM",w(kt).name),pt=null,u=!0):(c=gt(a),a=t.priority,r=fr(),s=gt(a),dr(c,s)&&(!dt||l.isTaskScheduledAtPriorityOrHigher(s))&&(f=!0)),t=t._nextJob;while(t&&!r&&!f&&!er(gt(a)));ct=!1}}finally{for(pt=null,u||(v(t,"job-error","info"),v(t,"job-running","StopTM",w(kt).name),t.cancel()),+i===i&&tt("priority","StopTM",w(i).name),e=!1;a>=p.min&&!e;){r=!1;t=w(a)._nextJob;do t instanceof it?e=!0:(a=t.priority,r=fr()),t=t._nextJob;while(t&&!r&&!e)}b=u?o?"timeslice exhausted":a<p.min?"jobs exhausted":f?"reached WWA priority boundary":"WWA host work":"job error";n&&(ui=null);ni=!1;a>=p.min&&pi();tt("yielding","info",b);tt("timeslice","StopTM")}}function pi(n){var t,i,r;(+n!==n&&(n=a),t=gt(n),ni)||ui&&(!dt||kr(ui,t))||(i=++vi,r=function(){yi<i&&(yi=vi,nu(!0))},l.execAsyncAtPriority(r,t),ui=t)}function tu(n,t){var u=hr++,i,r;return t===undefined&&(t="Drain Request "+u),n=+n===n?n:p.min,n=li(n),r=new s(function(r){i=r;yr(n,i,t)},function(){pr(i,!0)}),ni||pi(),r}function iu(n){return l.execAtPriority(n,l.HIGH)}function ru(){return new ki}function or(n,t,i,r){t=t||p.normal;i=i||null;var u=++sr,f=e._traceAsyncOperationStarting("WinJS.Utilities.Scheduler.schedule: "+u+fi(r));return r=r||"",new it(u,n,t,i,r,f)}function uu(){if(ni)return kt;switch(l.getCurrentPriority()){case l.HIGH:return p.high;case l.NORMAL:return p.normal;case l.IDLE:return p.idle}}function ti(n){return function(t,i){var r;return new s(function(u){r=or(function(){u(t)},n,null,i)},function(){r.cancel()})}}var wi,it,h,lt,ai,vi,yi;i.Namespace.define("WinJS.Utilities",{_linkedListMixin:ii});wi={get jobInfoIsNoLongerValid(){return"The job info object can only be used while the job is running"}};it=i.Class.define(function(n,t,i,r,u,f){this._id=n;this._work=t;this._context=r;this._name=u;this._asyncOpID=f;this._setPriority(i);this._setState(di);v(this,"job-scheduled","info")},{completed:{get:function(){return!!this._state.completed}},id:{get:function(){return this._id}},name:{get:function(){return this._name},set:function(n){this._name=n}},owner:{get:function(){return this._owner},set:function(n){this._owner&&this._owner._remove(this);this._owner=n;this._owner&&this._owner._add(this)}},priority:{get:function(){return this._priority},set:function(n){n=li(n);this._state.setPriority(this,n)}},cancel:function(){this._state.cancel(this)},pause:function(){this._state.pause(this)},resume:function(){this._state.resume(this)},_execute:function(n){this._state.execute(this,n)},_executeDone:function(n){return this._state.executeDone(this,n)},_blockedDone:function(n){return this._state.blockedDone(this,n)},_setPriority:function(n){+this._priority===this._priority&&this._priority!==n&&v(this,"job-priority-changed","info",w(this._priority).name,w(n).name);this._priority=n},_setState:function(n,t,i){this._state&&u.log&&u.log("Transitioning job ("+this.id+") from: "+this._state.name+" to: "+n.name,"winjs scheduler","log");this._state=n;this._state.enter(this,t,i)}});i.Class.mix(it,ii("Job"));var k={complete:1,"continue":2,block:3},bi=i.Class.define(function(n,t){this._job=t;this._result=null;this._yieldPolicy=k.complete;this._shouldYield=n},{job:{get:function(){return this._throwIfDisabled(),this._job}},shouldYield:{get:function(){return this._throwIfDisabled(),this._shouldYield()}},setPromise:function(n){this._throwIfDisabled();this._result=n;this._yieldPolicy=k.block},setWork:function(n){this._throwIfDisabled();this._result=n;this._yieldPolicy=k.continue},_disablePublicApi:function(){this._publicApiDisabled=!0},_throwIfDisabled:function(){if(this._publicApiDisabled)throw new r("WinJS.Utilities.Scheduler.JobInfoIsNoLongerValid",wi.jobInfoIsNoLongerValid);}}),ki=i.Class.define(function(){this._jobs={}},{cancelAll:function(){var t=this._jobs,i=Object.keys(t),n,r;for(this._jobs={},n=0,r=i.length;n<r;n++)t[i[n]].cancel()},_add:function(n){this._jobs[n.id]=n},_remove:function(n){delete this._jobs[n.id]}});var b=i.Class.define(function(n){this.name=n;this.enter=ft;this.execute=ft;this.executeDone=ft;this.blockedDone=ft;this.cancel=ft;this.pause=ft;this.resume=ft;this.setPriority=ft}),di=new b("created"),rt=new b("scheduled"),at=new b("paused"),d=new b("canceled"),vt=new b("running"),et=new b("running_paused"),yt=new b("running_resumed"),ut=new b("running_canceled"),gi=new b("running_canceled_blocked"),ri=new b("cooperative_yield"),ei=new b("cooperative_yield_paused"),oi=new b("blocked"),ot=new b("blocked_waiting"),nr=new b("blocked_paused"),st=new b("blocked_paused_waiting"),ht=new b("blocked_canceled"),nt=new b("complete");di.enter=function(n){ci(n,n.priority);n._setState(rt)};rt.enter=function(){pi()};rt.execute=g(vt);rt.cancel=g(d);rt.pause=g(at);rt.resume=c;rt.setPriority=function(n,t){n.priority!==t&&(n._setPriority(t),n.pause(),n.resume())};at.enter=function(n){v(n,"job-paused","info");n._removeJob()};at.cancel=g(d);at.pause=c;at.resume=function(n){v(n,"job-resumed","info");ci(n,n.priority);n._setState(rt)};at.setPriority=wt;d.enter=function(n){v(n,"job-canceled","info");e._traceAsyncOperationCompleted(n._asyncOpID,t.Debug&&t.Debug.MS_ASYNC_OP_STATUS_CANCELED);n._removeJob();n._work=null;n._context=null;n.owner=null};d.cancel=c;d.pause=c;d.resume=c;d.setPriority=c;vt.enter=function(n,t){var i,f;n._removeJob();var r=n.priority,o=n._work,u=n._context;n._work=null;n._context=null;i=new bi(t,n);e._traceAsyncCallbackStarting(n._asyncOpID);try{l.execAtPriority(function(){o.call(u,i)},gt(r))}finally{e._traceAsyncCallbackCompleted();i._disablePublicApi()}n._context=u;f=n._executeDone(i._yieldPolicy);n._setState(f,i._result,r)};vt.executeDone=function(n,t){switch(t){case k.complete:return nt;case k.continue:return ri;case k.block:return oi}};vt.cancel=function(n){ct=!0;n._setState(ut)};vt.pause=function(n){ct=!0;n._setState(et)};vt.resume=c;vt.setPriority=wt;et.enter=c;et.executeDone=function(n,t){switch(t){case k.complete:return nt;case k.continue:return ei;case k.block:return nr}};et.cancel=g(ut);et.pause=c;et.resume=g(yt);et.setPriority=wt;yt.enter=c;yt.executeDone=function(n,t){switch(t){case k.complete:return nt;case k.continue:return ri;case k.block:return oi}};yt.cancel=g(ut);yt.pause=g(et);yt.resume=c;yt.setPriority=wt;ut.enter=c;ut.executeDone=function(n,t){switch(t){case k.complete:case k.continue:return d;case k.block:return gi}};ut.cancel=c;ut.pause=c;ut.resume=c;ut.setPriority=c;gi.enter=function(n,t){t.cancel();n._setState(d)};ri.enter=function(n,t,i){v(n,"job-yielded","info");i===n.priority?gr(n,n.priority):ci(n,n.priority);n._work=t;n._setState(rt)};ei.enter=function(n,t){v(n,"job-yielded","info");n._work=t;n._setState(at)};oi.enter=function(n,t,i){v(n,"job-blocked","StartTM");n._work=t;n._setState(ot);t.done(function(t){v(n,"job-blocked","StopTM");var r=n._blockedDone(t);n._setState(r,t,i)},function(t){return t&&t.name==="Canceled"||v(n,"job-error","info"),v(n,"job-blocked","StopTM"),n._setState(d),s.wrapError(t)})};ot.enter=c;ot.blockedDone=function(n,t){return typeof t=="function"?ri:nt};ot.cancel=g(ht);ot.pause=g(st);ot.resume=c;ot.setPriority=wt;nr.enter=function(n,t,i){v(n,"job-blocked","StartTM");n._work=t;n._setState(st);t.done(function(t){v(n,"job-blocked","StopTM");var r=n._blockedDone(t);n._setState(r,t,i)},function(t){return t&&t.name==="Canceled"||v(n,"job-error","info"),v(n,"job-blocked","StopTM"),n._setState(d),s.wrapError(t)})};st.enter=c;st.blockedDone=function(n,t){return typeof t=="function"?ei:nt};st.cancel=g(ht);st.pause=c;st.resume=g(ot);st.setPriority=wt;ht.enter=function(n){n._work.cancel();n._work=null};ht.blockedDone=function(){return d};ht.cancel=c;ht.pause=c;ht.resume=c;ht.setPriority=c;nt.completed=!0;nt.enter=function(n){e._traceAsyncOperationCompleted(n._asyncOpID,t.Debug&&t.Debug.MS_ASYNC_OP_STATUS_SUCCESS);n._work=null;n._context=null;n.owner=null;v(n,"job-completed","info")};nt.cancel=c;nt.pause=c;nt.resume=c;nt.setPriority=c;h=i.Class.define(function(n,t){this.priority=n;this.name=t},{});i.Class.mix(h,ii("Job"),ii("Marker"));var sr=0,hr=0,cr=-15,tr=15,p={max:15,high:13,aboveNormal:9,normal:0,belowNormal:-9,idle:-13,min:-15},bt=[new h(15,"max"),new h(14,"14"),new h(13,"high"),new h(12,"12"),new h(11,"11"),new h(10,"10"),new h(9,"aboveNormal"),new h(8,"8"),new h(7,"7"),new h(6,"6"),new h(5,"5"),new h(4,"4"),new h(3,"3"),new h(2,"2"),new h(1,"1"),new h(0,"normal"),new h(-1,"-1"),new h(-2,"-2"),new h(-3,"-3"),new h(-4,"-4"),new h(-5,"-5"),new h(-6,"-6"),new h(-7,"-7"),new h(-8,"-8"),new h(-9,"belowNormal"),new h(-10,"-10"),new h(-11,"-11"),new h(-12,"-12"),new h(-13,"idle"),new h(-14,"-14"),new h(-15,"min"),new h(-16,"<TAIL>")];var ui=null,ni,kt,pt=null,dt=!!(t.MSApp&&t.MSApp.execAtPriority),y=[],ct,ir=30,a=p.min;bt.reduce(function(n,t){return n&&(n._insertJobAfter(t),n._insertMarkerAfter(t)),t});var br=t.setImmediate?t.setImmediate.bind(t):function(n){t.setTimeout(n,16)},hi={execAsyncAtPriority:function(n,i){i===l.HIGH&&t.setTimeout(n,0);br(n)},execAtPriority:function(n){return n()},getCurrentPriority:function(){return hi.NORMAL},isTaskScheduledAtPriorityOrHigher:function(){return!1},HIGH:"high",NORMAL:"normal",IDLE:"idle"},l=dt?t.MSApp:hi;lt={};lt[l.IDLE]=1;lt[l.NORMAL]=2;lt[l.HIGH]=3;ai=t.performance&&t.performance.now&&t.performance.now.bind(t.performance)||Date.now.bind(Date);vi=0;yi=0;i.Namespace._moduleDefine(n,"WinJS.Utilities.Scheduler",{Priority:p,schedule:or,createOwnerToken:ru,execHigh:iu,requestDrain:tu,currentPriority:{get:uu},schedulePromiseHigh:ti(p.high),schedulePromiseAboveNormal:ti(p.aboveNormal),schedulePromiseNormal:ti(p.normal),schedulePromiseBelowNormal:ti(p.belowNormal),schedulePromiseIdle:ti(p.idle),retrieveState:ar,_JobNode:it,_JobInfo:bi,_OwnerToken:ki,_dumpLis